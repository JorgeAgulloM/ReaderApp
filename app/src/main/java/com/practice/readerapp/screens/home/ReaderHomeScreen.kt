package com.practice.readerapp.screens.homeimport android.util.Logimport androidx.compose.foundation.clickableimport androidx.compose.foundation.horizontalScrollimport androidx.compose.foundation.layout.*import androidx.compose.foundation.rememberScrollStateimport androidx.compose.material.icons.Iconsimport androidx.compose.material.icons.filled.*import androidx.compose.material3.*import androidx.compose.runtime.Composableimport androidx.compose.ui.Alignmentimport androidx.compose.ui.Modifierimport androidx.compose.ui.graphics.Colorimport androidx.compose.ui.platform.LocalContextimport androidx.compose.ui.text.TextStyleimport androidx.compose.ui.text.font.FontWeightimport androidx.compose.ui.text.style.TextOverflowimport androidx.compose.ui.unit.dpimport androidx.compose.ui.unit.spimport androidx.hilt.navigation.compose.hiltViewModelimport androidx.navigation.NavControllerimport com.google.firebase.auth.FirebaseAuthimport com.practice.readerapp.components.*import com.practice.readerapp.model.MBookimport com.practice.readerapp.navigation.ReaderScreensimport com.practice.readerapp.ui.theme.COLOR_APP_PRIMARY@ExperimentalMaterial3Api@Composablefun Home(navController: NavController, viewModel: HomeScreenViewModel = hiltViewModel()) {    Scaffold(        topBar = { ReaderAppBar(title = "Reader App", navController = navController) },        floatingActionButton = {            FABContent {                navController.navigate(ReaderScreens.SearchScreen.name)            }        }) {        //PAra el scaffold con Material 3 hay que proveer a lo que tenemos dentro de padings        //usando el it para que no se sobrepongan los objetos.        Surface(            modifier = Modifier                .fillMaxSize()                .padding(top = it.calculateTopPadding())        ) {            HomeContent(navController = navController, viewModel = viewModel)        }    }}@OptIn(ExperimentalMaterial3Api::class)@Composablefun HomeContent(    navController: NavController = NavController(LocalContext.current),    viewModel: HomeScreenViewModel) {    var listOfBooks = emptyList<MBook>()    val currentUser = FirebaseAuth.getInstance().currentUser    if (!viewModel.data.value.data.isNullOrEmpty()) {        listOfBooks = viewModel.data.value.data!!.toList().filter { mBook ->            mBook.userId == currentUser?.uid.toString()        }        Log.d("HomeContent", "listOfBooks: ${listOfBooks.toString()}")    }    val email = FirebaseAuth.getInstance().currentUser?.email    val currentUsername = if (!email.isNullOrBlank())        FirebaseAuth.getInstance().currentUser?.email?.split("@")?.get(0)    else "N/A"    Column(        Modifier.padding(2.dp),        verticalArrangement = Arrangement.Top    ) {        Row(modifier = Modifier.align(alignment = Alignment.Start)) {            TitleSection(label = "Your reading \n " + " activity right now...")            Spacer(modifier = Modifier.fillMaxWidth(0.7f))            Column {                Icon(                    imageVector = Icons.Filled.AccountCircle,                    contentDescription = "Profile",                    modifier = Modifier                        .clickable {                            navController.navigate(                                ReaderScreens.ReaderStatsScreen.name                            )                        }                        .size(45.dp),                    tint = COLOR_APP_PRIMARY.copy(alpha = 0.5f))                Text(                    text = currentUsername!!,                    modifier = Modifier.padding(2.dp),                    style = MaterialTheme.typography.bodyLarge,                    maxLines = 1,                    overflow = TextOverflow.Clip                )                Divider()            }        }        ReadingRightNowArea(listOfBooks = listOfBooks, navController = navController)        TitleSection(label = "Reading List")        BookListArea(listOfBooks = listOfBooks, navController = navController)    }}@Composablefun BookListArea(listOfBooks: List<MBook>, navController: NavController) {    val addedBooks = listOfBooks.filter { mBook ->        mBook.startedReading == null && mBook.finishedReading == null    }    HorizontalScrollableComponent(addedBooks) {        navController.navigate(ReaderScreens.UpdateScreen.name + "/$it")    }}@Composablefun ReadingRightNowArea(listOfBooks: List<MBook>, navController: NavController) {    val readingNowList = listOfBooks.filter { mBook ->        mBook.startedReading != null && mBook.finishedReading == null    }    HorizontalScrollableComponent(listOfBooks = readingNowList) {        navController.navigate(ReaderScreens.UpdateScreen.name + "/$it")    }}@Composablefun HorizontalScrollableComponent(    listOfBooks: List<MBook>,    viewModel: HomeScreenViewModel = hiltViewModel(),    onCardPressed: (String) -> Unit) {    val scrollState = rememberScrollState()    Row(        modifier = Modifier            .fillMaxWidth()            .heightIn(280.dp)            .horizontalScroll(scrollState)    ) {        if (viewModel.data.value.loading == true) {            LinearProgressIndicator()        } else {            if (listOfBooks.isNullOrEmpty()) {                Surface(modifier = Modifier.padding(23.dp)) {                    Text(                        text = "You don't have any book in your reading list",                        style = TextStyle(color = Color.Red.copy(alpha = 0.4f)),                        fontWeight = FontWeight.Bold,                        fontSize = 14.sp                    )                }            } else {                for (book in listOfBooks) {                    ListCard(book) {                        onCardPressed(book.googleBookId.toString())                    }                }            }        }    }}